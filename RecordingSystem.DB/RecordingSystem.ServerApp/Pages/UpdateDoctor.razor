@page "/update-doctor/{Id:int}"

<h3>UpdateDoctor</h3>

<div>
	<span>Имя:</span><input type="text" @bind="_doctor.Name"/> <br />
	<span>Фамилия:</span><input type="text" @bind="_doctor.LastName"/> <br />
	<span>Мужчина: Да</span><input type="checkbox" @bind="_doctor.Male"/> <br />
	<span>Id cпециализации:</span><input type="text" @bind="_doctor.Specialization.Id"/> <br />    
	<span>Id кабинета:</span><input type="number" @bind="_doctor.Cabinet.Id"/> <br />    
	<button @onclick="EditDoctor">Сохранить изменения</button> <br />
	<NavLink href="/Doctors"><div class="back">Назад</div></NavLink>
</div>

@code {
	[Parameter] public int Id { get; set; }

	private DoctorOutputModel _doctor;

	protected override void OnInitialized()
	{
		var doctors = new DoctorManager().GetAllDoctors();
		int index = 0;
		int counter = -1;
		foreach (var i in doctors)
		{
			counter++;
			if (i.Id == Id)
			{
				index = counter;
			}
		}
		_doctor = doctors[index];
	}

	private void EditDoctor()
	{
		var doc = new DoctorInputModel()
			{
				Id = _doctor.Id,
				Name = _doctor.Name,
				LastName = _doctor.LastName,
				Male = _doctor.Male,
				PhoneNumber = _doctor.PhoneNumber,
				Email = _doctor.Email,
				SpecializationId = _doctor.Specialization.Id,
				CabinetId = _doctor.Cabinet.Id,
				Birthday = _doctor.Birthday
			};
		new DoctorManager().UpdateDoctor(doc);
	}
}
